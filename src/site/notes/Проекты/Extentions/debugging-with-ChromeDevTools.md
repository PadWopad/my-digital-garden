---
{"dg-publish":true,"permalink":"/proekty/extentions/debugging-with-chrome-dev-tools/","dgPassFrontmatter":true}
---



## Основы отладки простых расширений с помощью Chrome DevTools

Даже самые простые расширения могут содержать ошибки. Chrome DevTools – ваш лучший друг для поиска и исправления этих ошибок. В Модуле 5 мы подробно рассмотрим DevTools, но для начала давайте освоим базовые приемы отладки для простых расширений.

**Основные инструменты DevTools для отладки:**

*   **Console (Консоль):**
    *   **Описание:**  Отображает сообщения об ошибках, предупреждения, а также вывод `console.log()`.
    *   **Использование:**
        *   **Проверка ошибок:**  Консоль покажет JavaScript ошибки, которые возникают в вашем расширении. Внимательно читайте сообщения об ошибках, они часто указывают на место и причину проблемы.
        *   **Вывод отладочной информации:**  Используйте `console.log("Сообщение", переменная)` в вашем JavaScript коде, чтобы выводить значения переменных, проверять, выполняется ли код в нужных местах, и отслеживать ход выполнения программы.

*   **Sources (Источники):**
    *   **Описание:**  Позволяет просматривать исходный код вашего расширения (HTML, CSS, JavaScript файлы).
    *   **Использование:**
        *   **Просмотр кода:**  Убедитесь, что код, который вы написали, правильно загружается и выполняется.
        *   **Установка точек останова (breakpoints):**  Кликните на номер строки в JavaScript файле, чтобы установить точку останова. Когда выполнение кода дойдет до этой строки, выполнение остановится, и вы сможете пошагово изучить значения переменных и состояние программы.
        *   **Пошаговое выполнение кода:**  Используйте кнопки "Step over next function call" (F10), "Step into next function call" (F11), "Step out of current function call" (Shift+F11) для пошагового выполнения кода и отслеживания его работы.

**Как открыть DevTools для расширения:**

*   **Для всплывающего окна:**
    1.  Откройте всплывающее окно расширения, нажав на иконку в панели инструментов.
    2.  Щелкните правой кнопкой мыши внутри всплывающего окна.
    3.  Выберите "Просмотреть код" (Inspect).

*   **Для фонового скрипта (сервис-воркера):**
    1.  Перейдите на страницу `chrome://extensions/`.
    2.  Найдите ваше расширение и нажмите "Подробнее".
    3.  Найдите раздел "Инспектировать представления" (Inspect views) и нажмите ссылку "Сервисная страница" (Service worker page).

**Простой пример отладки:**

Предположим, у вас есть расширение, которое должно менять цвет фона страницы, но оно не работает.

**Код `popup.js` (с ошибкой):**

```javascript
document.addEventListener('DOMContentLoaded', function() {
  const changeColorBtn = document.getElementById('changeColorBtn');
  changeColorBtn.addEventListener('click', function() {
    chrome.scripting.executeScript({
      function: changeBackgroundColor
    });
  });
});

function changeBackgroundColor() {
  const randomColor = '#' + Math.floor(Math.random()*16777215).toString(16);
  document.body.style.backgroudColor = randomColor; // Ошибка: опечатка в "backgroundColor"
}
```

**Шаги отладки:**

1.  Загрузите расширение в Chrome.
2.  Откройте DevTools для всплывающего окна.
3.  Нажмите на иконку расширения и кнопку "Сменить цвет фона".
4.  Перейдите на вкладку **Console**. Вы должны увидеть сообщение об ошибке, например: "Uncaught TypeError: Cannot set property 'backgroudColor' of undefined".
5.  Ошибка указывает на проблему в функции `changeBackgroundColor` и свойстве `backgroudColor`.
6.  Перейдите на вкладку **Sources** и откройте файл `popup.js`.
7.  Просмотрите код функции `changeBackgroundColor`. Вы заметите опечатку: `document.body.style.backgroudColor` вместо `document.body.style.backgroundColor`.
8.  Исправьте опечатку в коде.
9.  Перезагрузите расширение на странице `chrome://extensions/`.
10. Повторите шаги 3 и 4. Ошибка должна исчезнуть, и цвет фона страницы должен меняться.

**Практическое задание:**

11.  Скопируйте код `popup.js` с ошибкой (опечаткой в `backgroundColor`) в расширение "Смена фона" из Модуля 2.
12.  Отладьте расширение, используя Chrome DevTools и вкладку Console, чтобы найти и исправить ошибку.
13.  Добавьте `console.log()` в разные места кода `popup.js` (например, в начале функции `changeBackgroundColor`, после генерации `randomColor`) и посмотрите, как эти сообщения отображаются в Console.
14.  Установите точку останова на строке `document.body.style.backgroudColor = randomColor;` в Sources и пошагово выполните код, чтобы увидеть значения переменных.

---

**5. Поиск и использование бесплатных иконок и ресурсов для расширений.**

Визуальное оформление расширения играет важную роль. Качественные иконки делают расширение более привлекательным и профессиональным. К счастью, существует множество ресурсов, где можно найти бесплатные иконки и другие графические элементы для ваших расширений.

**Ресурсы для поиска бесплатных иконок:**

*   **[Flaticon](https://www.flaticon.com/)**: Огромная база векторных иконок в различных стилях. Многие иконки доступны бесплатно (с указанием авторства).
*   **[Iconfinder](https://www.iconfinder.com/)**: Еще один большой ресурс с иконками. Есть как бесплатные, так и платные варианты. Фильтруйте поиск по "Free" для бесплатных иконок.
*   **[The Noun Project](https://thenounproject.com/)**: Библиотека иконок, ориентированная на символы и пиктограммы. Многие иконки бесплатны (с указанием авторства).
*   **[Icons8](https://icons8.com/)**:  Большая коллекция иконок, иллюстраций, фотографий и музыки. Бесплатный тарифный план с ограничениями.
*   **[Material Design Icons](https://materialdesignicons.com/)**: Набор иконок в стиле Material Design от Google. Бесплатные и с открытым исходным кодом.
*   **[Font Awesome](https://fontawesome.com/)**: Популярный набор векторных иконок, которые можно использовать как шрифты или SVG. Бесплатная версия доступна.

**Советы по выбору иконок:**

*   **Размер и формат:**  Для расширений Chrome обычно используются иконки в формате PNG размерами 16x16, 32x32, 48x48, 128x128 пикселей. Убедитесь, что выбранные иконки доступны в нужных размерах или их можно легко масштабировать.
*   **Стиль:**  Выберите иконки, которые соответствуют стилю вашего расширения и общей стилистике Chrome.
*   **Цвет:**  Иконки должны быть хорошо видны на светлом и темном фоне панели инструментов Chrome. Рассмотрите использование прозрачного фона.
*   **Лицензия:**  Внимательно читайте лицензию на использование иконок. Большинство бесплатных ресурсов требуют указания авторства (упоминания автора и ресурса в описании расширения или в файле `README`).

**Как использовать иконки в расширении:**

15.  **Скачайте иконки:**  Найдите подходящие иконки на одном из ресурсов, скачайте их в формате PNG и нужных размерах.
16.  **Создайте папку `images`:**  В папке вашего расширения создайте папку с названием `images`.
17.  **Поместите иконки в папку `images`:**  Скопируйте скачанные иконки в папку `images` и переименуйте их в соответствии с размерами (например, `icon16.png`, `icon48.png`, `icon128.png`).
18.  **Укажите пути к иконкам в `manifest.json`:**  В секциях `"action"` (`default_icon`) и `"icons"` файла `manifest.json` укажите пути к вашим иконкам относительно папки `images`. (Примеры уже были в теме 1).

**Другие бесплатные ресурсы:**

*   **Бесплатные изображения и иллюстрации:** [Unsplash](https://unsplash.com/), [Pexels](https://www.pexels.com/), [Pixabay](https://pixabay.com/) – для фоновых изображений, иллюстраций для всплывающих окон или страниц настроек (если необходимо).
*   **Бесплатные шрифты:** [Google Fonts](https://fonts.google.com/), [Font Squirrel](https://www.fontsquirrel.com/) – для улучшения типографики в UI расширения.
*   **Бесплатные звуки и музыка:** [Freesound](https://freesound.org/), [Bensound](https://www.bensound.com/) – для звуковых эффектов или фоновой музыки (если применимо).

**Практическое задание:**

19.  Найдите набор бесплатных иконок для расширения "Привет, мир!" на Flaticon или Iconfinder.
20.  Скачайте иконки разных размеров (16x16, 48x48, 128x128) в формате PNG.
21.  Создайте папку `images` в папке расширения и поместите туда иконки.
22.  Обновите `manifest.json` расширения "Привет, мир!", указав пути к новым иконкам в секциях `"action"` и `"icons"`.
23.  Обновите расширение в Chrome и проверьте, что иконка расширения изменилась.
